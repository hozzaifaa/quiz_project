<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Multi-Quiz App</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f8f9fa; }
    .sidebar { min-height: 100vh; background: #fff; border-right: 1px solid #ddd; padding: 20px; }
    .card { margin-bottom: 20px; }
    .feedback { margin-top: 10px; font-size: 0.95rem; }
    .correct { color: green; font-weight: bold; }
    .wrong { color: red; font-weight: bold; }
    #scoreBox { margin-top: 20px; font-size: 1.2rem; font-weight: bold; }
  </style>
</head>
<body>
  <div class="container-fluid">
    <div class="row">
      <!-- Sidebar -->
      <nav class="col-md-3 col-lg-2 sidebar">
        <h4>Choose a Quiz</h4>
        <ul class="nav flex-column" id="quizList">
          <li class="nav-item"><a href="#" class="nav-link" data-file="quiz1.js">Quiz 1</a></li>
          <li class="nav-item"><a href="#" class="nav-link" data-file="quiz2.js">Quiz 2</a></li>
          <li class="nav-item"><a href="#" class="nav-link" data-file="quiz3.js">Quiz 3</a></li>
          <li class="nav-item"><a href="#" class="nav-link" data-file="quiz4.js">Quiz 4</a></li>
          <li class="nav-item"><a href="#" class="nav-link" data-file="quiz5.js">Quiz 5</a></li>
          <li class="nav-item"><a href="#" class="nav-link" data-file="quiz6.js">Quiz 6</a></li>
          <li class="nav-item"><a href="#" class="nav-link" data-file="quiz7.js">Quiz 7</a></li>
          <li class="nav-item"><a href="#" class="nav-link" data-file="quiz8.js">Quiz 8</a></li>
          <li class="nav-item"><a href="#" class="nav-link" data-file="quiz9.js">Quiz 9</a></li>
          <li class="nav-item"><a href="#" class="nav-link" data-file="quiz10.js">Quiz 10</a></li>
        </ul>
      </nav>

      <!-- Main content -->
      <main class="col-md-9 col-lg-10 p-4">
        <h1 class="text-center mb-4">üìò Class Quiz</h1>
        <div id="quiz-container">üëâ Select a quiz from the sidebar</div>

        <div class="text-center mt-4">
          <button id="finishBtn" class="btn btn-success me-2" disabled>Finish & Score</button>
          <button id="showAllBtn" class="btn btn-info me-2" disabled>Show All Answers</button>
          <button id="resetBtn" class="btn btn-secondary" disabled>Reset</button>
        </div>

        <div id="scoreBox" class="text-center"></div>
      </main>
    </div>
  </div>

  <script>
    const container = document.getElementById('quiz-container');
    const finishBtn = document.getElementById('finishBtn');
    const showAllBtn = document.getElementById('showAllBtn');
    const resetBtn = document.getElementById('resetBtn');
    const scoreBox = document.getElementById('scoreBox');

    let currentQuiz = [];

    // Shuffle helper
    function shuffle(array) {
      return array.sort(() => Math.random() - 0.5);
    }

    function renderQuiz() {
      container.innerHTML = '';
      currentQuiz = shuffle(window.quiz); // shuffle questions
      currentQuiz.forEach((q, idx) => {
        const card = document.createElement('div');
        card.className = 'card p-3 shadow-sm';

        const qTitle = document.createElement('h5');
        qTitle.innerHTML = `Q${idx + 1}: ${q.question}`;
        card.appendChild(qTitle);

        shuffle(q.options).forEach(opt => {
          const div = document.createElement('div');
          div.className = 'form-check';
          const input = document.createElement('input');
          input.type = 'radio';
          input.name = 'q' + idx;
          input.value = opt;
          input.className = 'form-check-input';
          const label = document.createElement('label');
          label.className = 'form-check-label';
          label.textContent = opt;
          div.appendChild(input);
          div.appendChild(label);
          card.appendChild(div);
        });

        const feedback = document.createElement('div');
        feedback.className = 'feedback text-muted';
        feedback.textContent = 'No answer yet.';
        card.appendChild(feedback);

        container.appendChild(card);
      });

      finishBtn.disabled = false;
      showAllBtn.disabled = false;
      resetBtn.disabled = false;
    }

    function gradeQuiz() {
      let correct = 0;
      currentQuiz.forEach((q, idx) => {
        const card = container.children[idx];
        const selected = card.querySelector('input[type=radio]:checked');
        const feedback = card.querySelector('.feedback');

        if (selected && selected.value === q.answer) {
          correct++;
          feedback.className = 'feedback correct';
          feedback.textContent = '‚úÖ Correct!';
        } else {
          feedback.className = 'feedback wrong';
          feedback.innerHTML = `‚ùå Wrong. Correct: <b>${q.answer}</b><br><small>${q.explain || ''}</small>`;
        }
      });
      scoreBox.textContent = `Final Score: ${correct} / ${currentQuiz.length}`;
    }

    function showAllAnswers() {
      currentQuiz.forEach((q, idx) => {
        const card = container.children[idx];
        const feedback = card.querySelector('.feedback');
        feedback.className = 'feedback correct';
        feedback.innerHTML = `‚úÖ Correct answer: <b>${q.answer}</b><br><small>${q.explain || ''}</small>`;
      });
    }

    function resetQuiz() {
      scoreBox.textContent = '';
      renderQuiz();
    }

    // Load quiz dynamically
    document.getElementById('quizList').addEventListener('click', async (e) => {
      if (e.target.dataset.file) {
        e.preventDefault();
        const file = e.target.dataset.file;

        // Remove old script if any
        const oldScript = document.getElementById('quizScript');
        if (oldScript) oldScript.remove();

        // Load new quiz script
        const script = document.createElement('script');
        script.src = file + '?t=' + Date.now(); // prevent caching
        script.id = 'quizScript';
        script.onload = () => {
          if (window.quiz) {
            renderQuiz();
            scoreBox.textContent = '';
          }
        };
        document.body.appendChild(script);
      }
    });

    // Button actions
    finishBtn.onclick = gradeQuiz;
    showAllBtn.onclick = showAllAnswers;
    resetBtn.onclick = resetQuiz;
  </script>
</body>
</html>
